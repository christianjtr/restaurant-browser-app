import{r as a,j as e,P as g,a as p,b as S,c as R,u as I,G as $,L as O}from"./index-B4oT0Ax-.js";import{f as b,u as M,S as P}from"./currency.utils-BrmghFJV.js";import{R as _}from"./restaurant.services-CPXhJiKJ.js";import{r as B,S as T,P as F}from"./restaurant.adapter-B5UJ0i04.js";const A=s=>{const{items:n,onSelectItem:o,className:l="flex flex-row"}=s,[r,i]=a.useState(null),u=t=>{const c=r===t?null:t;i(c),o(c)};return e.jsx("div",{className:`tag-line ${l}`,children:n.map((t,c)=>e.jsx("button",{id:`btn-catalog-${t}`,name:`btn-catalog-${t}`,onClick:()=>u(t),className:`btn rounded-badge poppins-regular bg-white border-none shadow-none text-base mr-3 ${r===t?"background-color--base text-white":""}`,"data-testid":`btn-catalog-${t}`,"data-cy":`btn-catalog-${t}`,children:t},`tag_${t}_${c}`))})},D=s=>{const{message:n,onClick:o}=s,l=()=>{o()};return e.jsx("button",{id:"btn-purchase",name:"btn-purchase",className:"btn btn-lg background-color--base text-white poppins-medium text-lg uppercase border-none w-full","data-testid":"btn-purchase","data-cy":"btn-purchase",onClick:l,children:n})},Z=(s,n)=>{const[o,l]=a.useState(null),[r,i]=a.useState(!1),[u,t]=a.useState(!1);return a.useEffect(()=>{i(!0),n&&(async()=>{try{const c=await _.getRestaurantById(s),h=B(c,n);l(h)}catch(c){throw t(!0),new Error(`Error fetching restaurant, [Error]: ${c}`)}finally{i(!1)}})()},[n]),{restaurant:o,isLoading:r,hasError:u}},H=s=>a.createElement("svg",{width:24,height:24,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.29415 2.86631C4.84873 2.86631 2.86634 4.8487 2.86634 7.29412C2.86634 9.73953 4.84873 11.7219 7.29415 11.7219C9.73956 11.7219 11.722 9.73953 11.722 7.29412C11.722 4.8487 9.73956 2.86631 7.29415 2.86631ZM1.8396 7.29412C1.8396 4.28165 4.28168 1.83957 7.29415 1.83957C10.3066 1.83957 12.7487 4.28165 12.7487 7.29412C12.7487 10.3066 10.3066 12.7487 7.29415 12.7487C4.28168 12.7487 1.8396 10.3066 1.8396 7.29412Z",fill:"white"}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.4249 10.4252C10.6254 10.2248 10.9504 10.2248 11.1509 10.4252L14.0098 13.2841C14.2103 13.4846 14.2103 13.8096 14.0098 14.0101C13.8093 14.2106 13.4842 14.2106 13.2838 14.0101L10.4249 11.1512C10.2244 10.9508 10.2244 10.6257 10.4249 10.4252Z",fill:"white"})),W=s=>a.createElement("svg",{width:24,height:24,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.43042 1.54641C7.59787 1.43085 7.79651 1.36896 7.99996 1.36896C8.20342 1.36896 8.40206 1.43085 8.56951 1.54641C8.73568 1.6611 8.86334 1.82325 8.93581 2.01163L10.2276 5.2646L13.6872 5.48913C14.6235 5.5499 14.9498 6.72409 14.2624 7.29625L11.6044 9.50852C11.6043 9.50856 11.6044 9.50848 11.6044 9.50852C11.6042 9.50871 11.6039 9.50907 11.6038 9.50933C11.6037 9.50965 11.6037 9.50999 11.6038 9.51031L11.6041 9.51162L12.4613 12.8835C12.6783 13.7372 11.7568 14.5136 10.9515 14.0034L7.99996 12.1335L5.2582 13.8705C4.37703 14.4288 3.36134 13.5809 3.60085 12.6387L4.39578 9.51163L4.39612 9.51031C4.3962 9.50999 4.39619 9.50965 4.39609 9.50933C4.39601 9.50907 4.39586 9.50883 4.39567 9.50864C4.39563 9.5086 4.39572 9.50868 4.39567 9.50864L1.73757 7.29625L2.06598 6.90167M2.06598 6.90167L1.73757 7.29625C1.05013 6.72409 1.37645 5.5499 2.31271 5.48913L5.77236 5.2646L7.06412 2.01163C7.13659 1.82325 7.26424 1.66109 7.43042 1.54641M7.9847 12.1238L8.25944 11.6901L7.98376 12.1232C7.98407 12.1234 7.98438 12.1236 7.9847 12.1238ZM8.53511 11.2571C8.535 11.257 8.53523 11.2571 8.53511 11.2571L11.4594 13.1098L10.6094 9.7659C10.6093 9.76567 10.6093 9.76544 10.6092 9.76522C10.5612 9.57791 10.567 9.38087 10.6259 9.19668C10.6848 9.01227 10.7946 8.84825 10.9426 8.72347L10.9451 8.72141L13.5992 6.51232L10.143 6.28801C9.95243 6.27439 9.76963 6.2069 9.6159 6.09341C9.46279 5.98039 9.3448 5.82636 9.27553 5.64913L7.99996 2.43692L6.72439 5.64913C6.65513 5.82635 6.53714 5.98039 6.38403 6.09341C6.2303 6.2069 6.04749 6.27438 5.85689 6.288L5.85356 6.28824L2.40067 6.51232L5.05483 8.72142L5.05728 8.72347C5.20531 8.84825 5.31511 9.01227 5.37407 9.19668C5.43293 9.38081 5.43871 9.5778 5.39075 9.76505C5.39068 9.76533 5.39061 9.76562 5.39054 9.7659L4.59594 12.8917C4.58813 12.9224 4.59183 12.9422 4.59684 12.9557C4.60279 12.9717 4.61421 12.9874 4.62999 12.9994C4.64578 13.0114 4.66036 13.0155 4.66966 13.0161C4.67573 13.0165 4.68762 13.0166 4.7087 13.0032L7.46481 11.2571C7.46463 11.2572 7.46499 11.2569 7.46481 11.2571C7.62462 11.1555 7.81059 11.1012 7.99996 11.1012C8.18941 11.1012 8.37527 11.1554 8.53511 11.2571Z",fill:"white"})),q=s=>a.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},a.createElement("path",{d:"M2.5 8H13.5",stroke:"white",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M8 2.5V13.5",stroke:"white",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),G=s=>a.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},a.createElement("path",{d:"M2.5 8H13.5",stroke:"#262638",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),U=s=>{const{data:n}=s,{dispatch:o}=a.useContext(g),[l,r]=a.useState(0),i=()=>{r(t=>t+1),o({type:p.SET_ITEM_TO_ORDER,payload:{item:n}})},u=()=>{r(t=>t-1),o({type:p.DELETE_ITEM_FROM_ORDER,payload:{itemName:n.name}})};return e.jsxs("div",{className:"card product-item shadow--base",children:[e.jsx("div",{className:"flex-grow",children:e.jsx("figure",{className:"w-auto rounded-xl p-3 max-h-40 overflow-hidden",children:e.jsx("img",{src:n.image,alt:`Product ${n.name}`,className:"rounded-xl p-2 object-cover w-5/6",onError:({currentTarget:t})=>{t.src="https://placehold.co/200x200/FFF/CCCCCC?text=No+Image",t.onerror=null}})})}),e.jsxs("div",{className:"card-body items-center flex justify-end p-3",children:[e.jsx("h4",{className:"color--base poppins-regular block w-full text-center md:text-left product-name",children:n.name}),e.jsxs("div",{className:"w-full flex gap-5 lg:gap-0 flex-col lg:flex-row lg:justify-between items-center justify-around",children:[e.jsx("span",{className:"poppins-semibold",children:b(n.price)}),e.jsxs("div",{className:"flex items-center justify-around",children:[l>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-circle bg-white border-color--base",onClick:u,children:e.jsx(G,{})}),e.jsx("span",{className:"poppins-regular text-md min-w-5 mx-2 text-center",children:l})]}),e.jsx("button",{className:"btn btn-sm btn-circle background-color--base",onClick:i,children:e.jsx(q,{})})]})]})]})]})},V=s=>{const{catalog:n,className:o="grid grid-cols-2 gap-5 my-7 sm:px-0 md:px-2"}=s,l=n.map(r=>r.products.map(i=>({...i,catalog:r.name}))).flat();return e.jsx("div",{className:`product-list ${o}`,"data-testid":"product-list","data-cy":"product-list",children:l.map((r,i)=>e.jsx(U,{data:r},`product_${i}_${r.name}`))})},Q=()=>{const{restaurantId:s}=S(),{state:n}=R(),o=I(),{state:{order:{total:l,qtyItems:r}},dispatch:i}=a.useContext(g),{state:{userGeolocation:u}}=a.useContext($),{isLoading:t,catalog:c}=M(s),{isLoading:h,restaurant:C}=Z(s,u),{restaurant:f}=n,[j,w]=a.useState(null),v=()=>{i({type:p.CLEAR_ORDER}),o(-1)},L=()=>{o(`/restaurants/${s}/search`)},N=x=>{const m=c==null?void 0:c.filter(({name:E})=>E===x);w(m&&(m==null?void 0:m.length)>0?m:null)},k=()=>{o("/checkout")},y=r>0,d=C||f;return t||h?e.jsx(O,{}):e.jsxs("div",{className:"restaurant-detail-page card w-full rounded-none",children:[e.jsxs("div",{children:[e.jsx("figure",{children:e.jsx("img",{src:d.image,alt:`Restaurant ${d.name} image`})}),e.jsxs("div",{className:"absolute w-full flex justify-between p-8 buttons top-0",children:[e.jsx("button",{id:"btn-back",name:"btn-back",className:"btn btn-circle",onClick:v,"data-testid":"btn-back","data-cy":"btn-back",children:e.jsx(P,{})}),e.jsxs("div",{className:"flex gap-5",children:[e.jsx("button",{id:"btn-search",name:"btn-search",className:"btn btn-circle",onClick:L,"data-testid":"btn-search","data-cy":"btn-search",children:e.jsx(H,{})}),e.jsx("button",{id:"btn-favorite",name:"btn-favorite",className:"btn btn-circle","data-testid":"btn-favorite","data-cy":"btn-favorite",children:e.jsx(W,{})})]})]})]}),e.jsxs("div",{className:"card-body relative",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("figure",{className:"restaurant-logo relative",children:e.jsx("img",{src:d.logo,alt:`Restaurant ${d.name} logo`})})}),e.jsxs("div",{className:"basis-full",children:[e.jsx("h2",{className:"card-title poppins-medium text-md uppercase color--base mb-3",children:d.name}),e.jsx("h4",{className:"card-category-title poppins-regular text-base color--neutral-n300 block",children:d.category}),e.jsxs("p",{className:"block restaurant-info color--neutral-n300 poppins-regular",children:[e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx("img",{src:T,className:"mr-2 info-icon",alt:"Start icon"}),`${d.ratings.average} (${d.ratings.total})`]}),e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx("img",{src:F,className:"mr-2 info-icon",alt:"Pin map icon"}),d.formattedDistance]})]})]})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx(A,{items:c.map(({name:x})=>x),onSelectItem:N}),e.jsx(V,{catalog:j||c})]}),e.jsx("div",{className:"purchase-button-container fixed left-1/2 transform -translate-x-1/2 -translate-y-1/2 bottom-12 flex w-3/4 md:w-1/3 justify-center",children:y&&e.jsx(D,{message:`TOTAL (${b(l)})`,onClick:k})})]})]})};export{Q as default};
